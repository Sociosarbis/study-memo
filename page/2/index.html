<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>a house in the woods</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="a house in the woods">
<meta property="og:url" content="https://sociosarbis.github.io/study-memo/page/2/index.html">
<meta property="og:site_name" content="a house in the woods">
<meta property="og:locale" content="zh">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="a house in the woods">
  
    <link rel="alternate" href="/study-memo/atom.xml" title="a house in the woods" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/study-memo/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/study-memo/" id="logo">a house in the woods</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/study-memo/">Home</a>
        
          <a class="main-nav-link" href="/study-memo/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/study-memo/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://sociosarbis.github.io/study-memo"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-web-front-end-knowledge-memo(Network)-ep1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/study-memo/2019/11/03/web-front-end-knowledge-memo(Network)-ep1/" class="article-date">
  <time datetime="2019-11-03T13:03:28.048Z" itemprop="datePublished">2019-11-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/study-memo/2019/11/03/web-front-end-knowledge-memo(Network)-ep1/">web前端知识学习笔记-网络篇(1)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="HTTP处于TCP-IP（互联网协议套件）的应用层，是一种无状态的协议。"><a href="#HTTP处于TCP-IP（互联网协议套件）的应用层，是一种无状态的协议。" class="headerlink" title="HTTP处于TCP/IP（互联网协议套件）的应用层，是一种无状态的协议。"></a>HTTP处于TCP/IP（互联网协议套件）的应用层，是一种无状态的协议。</h3><p><strong>（我的理解是无状态协议表示，每次请求应答都是独立的，不需要保证是否按顺序收发，不会维护client和server的状态，单次请求应答完成以后自动结束）</strong></p>
<h3 id="一次HTTP操作简化流程"><a href="#一次HTTP操作简化流程" class="headerlink" title="一次HTTP操作简化流程"></a>一次HTTP操作简化流程</h3><ol>
<li>发送HTTP请求（浏览器输入地址或XHR等方式）</li>
<li>通过DNS获取请求地址对应的IP地址</li>
<li>通过TCP/IP，与目标地址建立起TCP连接</li>
<li>TCP连接发送客户端的HTTP请求报文</li>
<li>客户端通过TCP连接发送HTTP应答报文</li>
<li>TCP连接关闭，如果HTTP请求报头中设置了<code>Connection:keep-alive</code>，则TCP会继续保持连接</li>
</ol>
<p><strong>值得注意的是keep-alive虽然是通过HTTP的报头设置的，但是实际执行的是在TCP中，所以不与HTTP是无状态的冲突</strong></p>
<p><strong>短连接</strong>是无<code>keep-alive</code>，请求完成以后，TCP自动关闭；<br><strong>长连接</strong>则相反。</p>
<p><strong>管线化（with pipelining）</strong>是指长连接中客户端无需等待上一次请求完成，再去做第二次请求，<strong>非管线化（without pipelining）</strong>则需要做这样的等待。<br><em>但实际上没有看过非管线化的情况（如果有，还请热心告诉我）</em></p>
<h3 id="格式示意图"><a href="#格式示意图" class="headerlink" title="格式示意图"></a>格式示意图</h3><p>请求报文：<br><img src="css/images/http-request-format.png" alt=""></p>
<p>响应报文：<br><img src="css/images/http-response-format.png" alt=""><br><a href="https://juejin.im/post/5ad4465d6fb9a028da7d0117" target="_blank" rel="noopener">图片来源</a></p>
<h3 id="常见的响应的状态码"><a href="#常见的响应的状态码" class="headerlink" title="常见的响应的状态码"></a>常见的响应的状态码</h3><p><strong>200</strong>(OK) <strong>客户端发过来的数据被正常处理</strong></p>
<p><strong>204</strong>(Not Content) <strong>正常响应，没有实体</strong></p>
<p><strong>206</strong>(Partial Content) <strong>范围请求，返回部分数据，响应报文中由Content-Range指定实体内容</strong></p>
<hr>
<p><strong>301</strong>(Moved Permanently) <strong>永久重定向</strong></p>
<p><strong>302</strong>(Found) <strong>临时重定向，重定向后的请求方法可作改变</strong></p>
<p><strong>303</strong>(See Other) <strong>重定向后的请求方法变为GET</strong></p>
<p><strong>304</strong>(Not Modified) <strong>状态未改变， 配合(If-Match、If-Modified-Since、If-None_Match、If-Range、If-Unmodified-Since)，与<em>HTTP缓存</em>相关</strong></p>
<p><strong>307</strong>(Temporary Redirect) <strong>临时重定向，不应改变其请求方法</strong></p>
<hr>
<p><strong>400</strong>(Bad Request) <strong>请求报文语法错误</strong></p>
<p><strong>401</strong>(unauthorized) <strong>需要认证</strong></p>
<p><strong>403</strong>(Forbidden) <strong>服务器拒绝访问对应的资源</strong></p>
<p><strong>404</strong>(Not Found) <strong>服务器上无法找到资源</strong></p>
<p><strong><em>401跟403不同的地方是，401可能是因为你没有登录，而403表示可能你没有相关的权限，有一次我通过npm发布包，错误提示403，我还错误地想是不是因为我没有登录呢，实际上是我的包名含有private scope，而我没有权限导致的</em></strong></p>
<hr>
<p><strong>500</strong>(Internal Server Error)<strong>服务器故障</strong></p>
<p><strong>503</strong>(Service Unavailable) <strong>服务器处于超负载或正在停机维护</strong></p>
<h4 id="从维基百科的配图中，虽然是说明UDP的，但也可以看出在TCP-IP层间传输中，大致存在这样的迭代关系"><a href="#从维基百科的配图中，虽然是说明UDP的，但也可以看出在TCP-IP层间传输中，大致存在这样的迭代关系" class="headerlink" title="从维基百科的配图中，虽然是说明UDP的，但也可以看出在TCP/IP层间传输中，大致存在这样的迭代关系"></a>从维基百科的配图中，虽然是说明UDP的，但也可以看出在TCP/IP层间传输中，大致存在这样的迭代关系</h4><p>(<strong>n</strong>表示层序)</p>
<p><img src="https://latex.codecogs.com/png.latex?packet_%7Bn%20-%201%7D%20%3D%20header_%7Bn%20-%201%7D%20&plus;%20packet_%7Bn%7D" alt=""></p>
<p><img src="css/images/UDP_encapsulation.png" alt=""></p>
<p><em>本文内容大部分基于<a href="">5分钟让你明白HTTP协议</a><a href="https://juejin.im/post/5ad4465d6fb9a028da7d0117" target="_blank" rel="noopener">https://juejin.im/post/5ad4465d6fb9a028da7d0117</a></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sociosarbis.github.io/study-memo/2019/11/03/web-front-end-knowledge-memo(Network)-ep1/" data-id="ck64y70wa000tjgu1x3cfff87" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/HTTP/">HTTP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/interview/">interview</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-web-front-end-knowledge-memo(JS)-ep3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/study-memo/2019/11/02/web-front-end-knowledge-memo(JS)-ep3/" class="article-date">
  <time datetime="2019-11-02T13:41:15.157Z" itemprop="datePublished">2019-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/study-memo/2019/11/02/web-front-end-knowledge-memo(JS)-ep3/">web前端知识学习笔记-JS篇(3)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="变量提升与函数提升"><a href="#变量提升与函数提升" class="headerlink" title="变量提升与函数提升"></a>变量提升与函数提升</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outter</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> inner;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">inner</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">    <span class="keyword">var</span> inner;</span><br><span class="line">    inner = <span class="number">9</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typeof</span> outter() <span class="comment">// 'function';</span></span><br></pre></td></tr></table></figure>
<p>变量提升和函数提升指的是JS预编译的一个操作。</p>
<p>首先对于<code>var</code>声明的变量，只存在全局作用域和函数作用域，不像<code>let</code>和<code>const</code>还有块作用域。</p>
<ol>
<li>变量提升（指<code>var</code>声明的变量）指的是作用域内出现的变量声明会把声明放到作用域的开头</li>
<li>函数提升是指除了1外的操作，还会把函数提前赋值给变量</li>
</ol>
<p>根据上面两个规则，上面的代码经预编译会变成如下形式：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outter</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> inner;</span><br><span class="line">    inner = <span class="function"><span class="keyword">function</span> <span class="title">inner</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">    <span class="keyword">return</span> inner;</span><br><span class="line">    inner = <span class="number">9</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sociosarbis.github.io/study-memo/2019/11/02/web-front-end-knowledge-memo(JS)-ep3/" data-id="ck64y70w8000sjgu1e2sddc2d" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/hoisting/">hoisting</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/interview/">interview</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-web-front-end-knowledge-memo(JS)-ep2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/study-memo/2019/11/02/web-front-end-knowledge-memo(JS)-ep2/" class="article-date">
  <time datetime="2019-11-02T13:30:29.482Z" itemprop="datePublished">2019-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/study-memo/2019/11/02/web-front-end-knowledge-memo(JS)-ep2/">web前端知识学习笔记-JS篇(2)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="立即执行函数（immediatly-invoked-function-expression）"><a href="#立即执行函数（immediatly-invoked-function-expression）" class="headerlink" title="立即执行函数（immediatly invoked function expression）"></a>立即执行函数（immediatly invoked function expression）</h2><p>从题目总结其性质</p>
<ol>
<li><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> b = <span class="number">30</span>;</span><br><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">b</span>) </span>&#123;</span><br><span class="line">     a = <span class="number">10</span>;</span><br><span class="line">     b = <span class="number">20</span>;</span><br><span class="line">     <span class="built_in">console</span>.log(a)</span><br><span class="line">     <span class="built_in">console</span>.log(b);</span><br><span class="line">&#125;(<span class="number">10</span>))</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>总结：这里会输出a函数定义和20。</p>
<ol>
<li>性质一，IIFE的函数名，不会在括号外出现声明，所以不会与<code>const a</code>产生冲突错误。</li>
<li>IIFE的函数名可看作是<code>const</code>，对其再赋值会无效，在严格模式下会报错。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sociosarbis.github.io/study-memo/2019/11/02/web-front-end-knowledge-memo(JS)-ep2/" data-id="ck64y70w6000pjgu19mxpaklg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/IIFE/">IIFE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/interview/">interview</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/立即执行函数/">立即执行函数</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-web-front-end-knowledge-memo(JS)-ep1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/study-memo/2019/11/02/web-front-end-knowledge-memo(JS)-ep1/" class="article-date">
  <time datetime="2019-11-02T13:18:18.384Z" itemprop="datePublished">2019-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/study-memo/2019/11/02/web-front-end-knowledge-memo(JS)-ep1/">web前端知识学习笔记-JS篇(1)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>一条关于setTimeout和promise的执行顺序的题目。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'1'</span>);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'2'</span>);</span><br><span class="line">     <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">'3'</span>);</span><br><span class="line">          resolve();</span><br><span class="line">     &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">           <span class="built_in">console</span>.log(<span class="string">'4'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">&#125;, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'5'</span>);</span><br><span class="line">     resolve();</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'6'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'7'</span>);</span><br><span class="line">     <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">'8'</span>);</span><br><span class="line">          resolve();</span><br><span class="line">     &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'9'</span>)</span><br><span class="line">     &#125;)</span><br><span class="line">&#125;, <span class="number">2</span>)</span><br></pre></td></tr></table></figure></p>
<p>在浏览器中，其正确顺序是1,5,6,2,3,4,7,8,9<br>相关知识可以参照<a href="https://medium.com/@Rahulx1/understanding-event-loop-call-stack-event-job-queue-in-javascript-63dcd2c71ecd" target="_blank" rel="noopener">Understanding Event Loop, Call Stack, Event &amp; Job Queue in Javascript</a></p>
<p>简单总结就是</p>
<ol>
<li>先执行所有的同步代码，异步代码会放到eventloop执行, setTimeout会放到callback queue, promise会放到job queue</li>
<li>进入事件循环</li>
<li>执行job queue的代码，当promise是一个立刻resolve的promise，then产生的promise会在此时放到job queue，由于job queue中有这一步放置的task，所以会继续执行job queue，而不是跳到callback queue中</li>
<li>再执行callback queue的代码</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sociosarbis.github.io/study-memo/2019/11/02/web-front-end-knowledge-memo(JS)-ep1/" data-id="ck64y70w5000njgu1tnweknpp" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/eventloop/">eventloop</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/interview/">interview</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/promise/">promise</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/setTimeout/">setTimeout</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-web-front-end-knowledge-memo(HTML)-ep2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/study-memo/2019/11/02/web-front-end-knowledge-memo(HTML)-ep2/" class="article-date">
  <time datetime="2019-11-02T12:47:53.354Z" itemprop="datePublished">2019-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/study-memo/2019/11/02/web-front-end-knowledge-memo(HTML)-ep2/">web前端知识学习笔记-HTML篇(2)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>移动端的适配离不开meta标签的viewport设置，比较常见的设置<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>属性：</p>
<ol>
<li>width表示将document内容宽度设为width制定的数值，可填具体数值，如640，或device-width（表示device indepent pixel,简称DIP）</li>
<li>intial-scale, minimum-scale, maximum-scale，表示将可视窗口或者简单理解window.innerWidth，设为<code>DIP / scale</code>，例如当width设为640，而intial-scale设为2.0，那么<code>window.innerWidth === 320</code>，那么窗口内只能看到所有内容的一半。</li>
<li><p>关于刘海屏的适配，最开始由ios提出增加一个叫做viewport-fit的属性，一般可用contain 和 cover两个值，<br>具体效果可以看下面的示意图:</p>
<ol>
<li><strong>contain</strong></li>
</ol>
<p><img src="css/images/viewport-fit-contain.png" alt="contain"></p>
<ol start="2">
<li><strong>cover</strong></li>
</ol>
<p><img src="css/images/viewport-fit-contain.png" alt="cover"></p>
<p><a href="https://medium.com/@bobtung/%E9%9D%A2%E5%B0%8Diphone-x-web%E8%A8%AD%E8%A8%88%E5%B8%AB%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E5%B9%BE%E5%80%8Bcss%E5%B1%AC%E6%80%A7-b7c03b314c6a" target="_blank" rel="noopener">图片来源</a></p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sociosarbis.github.io/study-memo/2019/11/02/web-front-end-knowledge-memo(HTML)-ep2/" data-id="ck64y70w2000kjgu1bjtrjbv9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/HTML/">HTML</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/interview/">interview</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/meta/">meta</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/viewport/">viewport</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-web-front-end-knowledge-memo(HTML)-ep1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/study-memo/2019/11/02/web-front-end-knowledge-memo(HTML)-ep1/" class="article-date">
  <time datetime="2019-11-02T12:27:25.214Z" itemprop="datePublished">2019-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/study-memo/2019/11/02/web-front-end-knowledge-memo(HTML)-ep1/">web前端知识学习笔记-HTML篇(1)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="语义化，英文为semantics。"><a href="#语义化，英文为semantics。" class="headerlink" title="语义化，英文为semantics。"></a>语义化，英文为semantics。</h3><h3 id="根据MDN上的介绍，语义化的优点有"><a href="#根据MDN上的介绍，语义化的优点有" class="headerlink" title="根据MDN上的介绍，语义化的优点有"></a>根据MDN上的介绍，语义化的优点有</h3><ol>
<li>在SEO中会有较高权重</li>
<li>方便视觉障碍人士阅读页面</li>
<li>方便查找有特定意义的标签</li>
<li>提示开发者生成的数据类型</li>
<li>语义化仿照与自定义组件的命名</li>
</ol>
<h3 id="常见的新语义化标签"><a href="#常见的新语义化标签" class="headerlink" title="常见的新语义化标签"></a>常见的新语义化标签</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">article</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aside</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">details</span>&gt;</span> <span class="comment">&lt;!--与summary一起使用，点击details显示summary的内容--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">summary</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">figcaption</span>&gt;</span> <span class="comment">&lt;!--图片说明--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">figure</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mark</span>&gt;</span> <span class="comment">&lt;!--高亮，默认为黄色背景--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">nav</span>&gt;</span> <span class="comment">&lt;!--导航--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">section</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">time</span>&gt;</span> <span class="comment">&lt;!--时间--&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sociosarbis.github.io/study-memo/2019/11/02/web-front-end-knowledge-memo(HTML)-ep1/" data-id="ck64y70w1000jjgu1isxudoti" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/HTML/">HTML</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/interview/">interview</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/语义化/">语义化</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-web-front-end-knowledge-memo(CSS)-ep1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/study-memo/2019/11/02/web-front-end-knowledge-memo(CSS)-ep1/" class="article-date">
  <time datetime="2019-11-02T07:59:25.623Z" itemprop="datePublished">2019-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/study-memo/2019/11/02/web-front-end-knowledge-memo(CSS)-ep1/">web前端知识学习笔记-CSS篇(1)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li>一列自适应，一列固定的两列布局实现。<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 浮动脱离文档流 */</span></span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注意right要放在left前，float不占用空间的效果只对其后</span></span><br><span class="line"><span class="comment">的一个元素有效</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 或使用flex */</span></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>宽度为相对数值的正方形<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 如果相对的是window可用 */</span></span><br><span class="line"><span class="selector-class">.square</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">45vw</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">45vw</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 更通用的是使用padding来填充高度，因为padding的相对的是width*/</span></span><br><span class="line"><span class="selector-class">.square</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">45%</span>;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sociosarbis.github.io/study-memo/2019/11/02/web-front-end-knowledge-memo(CSS)-ep1/" data-id="ck64y70vz000ijgu1woc6hjpl" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/CSS/">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/interview/">interview</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-myer-diff" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/study-memo/2019/10/21/myer-diff/" class="article-date">
  <time datetime="2019-10-21T14:07:44.329Z" itemprop="datePublished">2019-10-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/study-memo/2019/10/21/myer-diff/">Myer&#39;s Diff algorithm</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文主要参考自<a href="http://simplygenius.net/Article/DiffTutorial1" target="_blank" rel="noopener">Myers’ Diff Algorithm(1)</a>（算法原理）和</p>
<p><a href="http://simplygenius.net/Article/DiffTutorial2" target="_blank" rel="noopener">Myers’ Diff Algorithm(2)</a>（优化后的算法）这两篇文章，</p>
<p>根据自己的理解对算法步骤进行说明。原论文（<a href="http://www.grantjenks.com/wiki/_media/ideas:diffalgorithmlcs.pdf）。" target="_blank" rel="noopener">http://www.grantjenks.com/wiki/_media/ideas:diffalgorithmlcs.pdf）。</a><br><strong>在本文中出现的名词如：</strong></p>
<ul>
<li><strong>snake</strong></li>
<li><strong>diagonal k（对角线k）</strong></li>
<li><strong>edit graph（编辑图）</strong></li>
<li><strong>furthest reaching point（最远到达点，实则为编辑图的横坐标）</strong></li>
<li><strong>V[k]（记录对角线k的最远到达点）</strong></li>
<li><strong>edit script（编辑路径）</strong><br>可在上述的参考文章中找到说明。<br><strong>算法的思想建基于:</strong></li>
</ul>
<ol>
<li>最短编辑距离的路径会包含一条有最远到达点的对角线</li>
<li>编辑路径D（D表示编辑长度）与对角线k的关系为<img src="https://latex.codecogs.com/gif.latex?k%20%5Cin%20%5B-D%2C-D%20&plus;%202%2C...%2CD%5D" alt=""><br><strong>注意编辑图的（0, 0）点不表示字符串A和B各自的第一个字符, 而是表示没有任何字符编辑的出发点</strong></li>
</ol>
<h3 id="algorithm1"><a href="#algorithm1" class="headerlink" title="algorithm1"></a>algorithm1</h3><p>初步的算法<strong>（在文章1中）</strong>就是从0开始到最大D循环，从每个D中拿到对角线k的序列，进行INSERT（B向前一步）或DELETE（A向前一步）的编辑。</p>
<p>看看后面的字符是否相同，如果相同则A和B的各向前一步；</p>
<p>如果不同则把当前的横坐标记回到V[k]中。如当前坐标到达边界，则当前的D就为最短编辑路径。</p>
<h3 id="algorithm2"><a href="#algorithm2" class="headerlink" title="algorithm2"></a>algorithm2</h3><ol start="2">
<li><p>在文章2中介绍了1中的算法的优化，它包含了分治的思想。<br>概括地说是</p>
<ol>
<li>记A B长度的差delta为N - M</li>
<li>从起始点正向执行1中的算法和从终点反向执行，它们的V[k]分别记为VForward[k]和VBackward[k]</li>
<li>当VForward[k] &gt; VBackward[k]时停止迭代，同时需要满足当delta为奇数时，<img src="https://latex.codecogs.com/gif.latex?D_%7Bbackward%7D%20%3D%20D_%7Bforward%7D%20-%201" alt="">,迭代要在Forward处结束；<br>当delta为偶数时<img src="https://latex.codecogs.com/gif.latex?D_%7Bbackward%7D%20%3D%20D_%7Bforward%7D%20" alt="">，迭代要在Backward时结束。</li>
<li>结束3中的最后一次迭代的路径称为middle snake，在原论文中证明middle snake为最短编辑路径的子路径</li>
<li>根据middle snake（左上角和上一次的出发点）和（右下角和上一次的终点）把编辑图分成左上和右下两个子图，这两个子问题。</li>
</ol>
<p>再重复执行这个这个算法，直到子问题的D不大于1，或者任意子字符串的长度等于0为止。</p>
</li>
<li><p>下面是应用算法2以求出从A到B字符串编辑操作的代码。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 操作类型</span></span><br><span class="line"><span class="keyword">const</span> RETAIN = <span class="string">'retain'</span> <span class="comment">// 保留A和B的字符</span></span><br><span class="line"><span class="keyword">const</span> INSERT = <span class="string">'insert'</span> <span class="comment">// 插入B字符，在图中表示为垂直移动</span></span><br><span class="line"><span class="keyword">const</span> DELETE = <span class="string">'delete'</span> <span class="comment">// 删除A字符，在途中表示为水平移动</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">calcMiddleSnake</span>(<span class="params">A, a0, N, B, b0, M, VForward, VBackward</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> delta = N - M</span><br><span class="line">  <span class="keyword">const</span> maxD = <span class="built_in">Math</span>.floor((N + M + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">  <span class="comment">//初始化V序列</span></span><br><span class="line">  VForward[<span class="number">1</span>] = <span class="number">0</span></span><br><span class="line">  <span class="comment">//初始的时候从delta - 1的对角线开始</span></span><br><span class="line">  VBackward[N - M - <span class="number">1</span>] = N</span><br><span class="line">  <span class="keyword">const</span> isOdd = <span class="built_in">Boolean</span>(delta &amp; <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> d = <span class="number">0</span>; d &lt;= maxD; d++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> k = -d; k &lt;= d; k += <span class="number">2</span>) &#123;</span><br><span class="line">      <span class="comment">// k为-d时必为向下，k为d时必为向右，其余情况选择V序列较大的方向，这里的方向表示从Kprev到K</span></span><br><span class="line">      <span class="keyword">const</span> down = k === -d || (k !== d &amp;&amp; VForward[k - <span class="number">1</span>] &lt; VForward[k + <span class="number">1</span>])</span><br><span class="line">      <span class="keyword">const</span> kPrev = down ? k + <span class="number">1</span> : k - <span class="number">1</span></span><br><span class="line">      <span class="keyword">const</span> startX = VForward[kPrev]</span><br><span class="line">      <span class="keyword">const</span> startY = startX - kPrev</span><br><span class="line">      <span class="keyword">const</span> midX = down ? startX : startX + <span class="number">1</span></span><br><span class="line">      <span class="keyword">const</span> midY = midX - k</span><br><span class="line">      <span class="keyword">let</span> endX = midX</span><br><span class="line">      <span class="keyword">let</span> endY = midY</span><br><span class="line">      <span class="keyword">while</span> (endX &lt; N &amp;&amp; endY &lt; M &amp;&amp; A[a0 + endX] === B[b0 + endY]) &#123;</span><br><span class="line">        endX++</span><br><span class="line">        endY++</span><br><span class="line">      &#125;</span><br><span class="line">      VForward[k] = endX</span><br><span class="line">      <span class="comment">// 当delta为奇数时，运行到这里才有反向d = 正向d - 1，才需要返回middleSnake，</span></span><br><span class="line">      <span class="comment">// k &lt; delta - (d - 1) || k &gt; delta + (d - 1)是保证正向k没有超出上一轮反向k的范围</span></span><br><span class="line">      <span class="keyword">if</span> (!isOdd || k &lt; delta - (d - <span class="number">1</span>) || k &gt; delta + (d - <span class="number">1</span>)) <span class="keyword">continue</span></span><br><span class="line">      <span class="keyword">if</span> (VForward[k] &lt; VBackward[k]) <span class="keyword">continue</span></span><br><span class="line">      <span class="keyword">return</span> [<span class="number">2</span> * d - <span class="number">1</span>, down, startX, startY, midX, midY, endX, endY]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 正向是以k = 0为中心，反向是以k = delta为中心</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> k = -d + delta; k &lt;= d + delta; k += <span class="number">2</span>) &#123;</span><br><span class="line">      <span class="comment">// 方向选择逻辑与正向相近</span></span><br><span class="line">      <span class="keyword">const</span> up = k === d + delta || (k !== -d + delta &amp;&amp; VBackward[k - <span class="number">1</span>] &lt; VBackward[k + <span class="number">1</span>])</span><br><span class="line">      <span class="keyword">const</span> kPrev = up ? k - <span class="number">1</span> : k + <span class="number">1</span></span><br><span class="line">      <span class="keyword">const</span> startX = VBackward[kPrev]</span><br><span class="line">      <span class="keyword">const</span> startY = startX - kPrev</span><br><span class="line">      <span class="keyword">const</span> midX = up ? startX : startX - <span class="number">1</span></span><br><span class="line">      <span class="keyword">const</span> midY = midX - k</span><br><span class="line">      <span class="keyword">let</span> endX = midX</span><br><span class="line">      <span class="keyword">let</span> endY = midY</span><br><span class="line">      <span class="keyword">while</span> (endX &gt; <span class="number">0</span> &amp;&amp; endY &gt; <span class="number">0</span> &amp;&amp; A[a0 + endX - <span class="number">1</span>] === B[b0 + endY - <span class="number">1</span>]) &#123;</span><br><span class="line">        endX--</span><br><span class="line">        endY--</span><br><span class="line">      &#125;</span><br><span class="line">      VBackward[k] = endX</span><br><span class="line">      <span class="comment">// 当delta为偶数时，运行到这里才有反向d = 正向，才需要返回middleSnake，</span></span><br><span class="line">      <span class="comment">// k &lt; -d || k &gt; d是保证反向k没有超出这一轮正向k的范围</span></span><br><span class="line">      <span class="keyword">if</span> (isOdd || k &lt; -d || k &gt; d) <span class="keyword">continue</span></span><br><span class="line">      <span class="keyword">if</span> (VBackward[k] &gt; VForward[k]) <span class="keyword">continue</span></span><br><span class="line">      <span class="keyword">return</span> [<span class="number">2</span> * d, up, endX, endY, midX, midY, startX, startY]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">innerDiff</span>(<span class="params">A, a0, N, B, b0, M, VForward, VBackward</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> newOps = []</span><br><span class="line">  <span class="keyword">if</span> (M === <span class="number">0</span> &amp;&amp; N &gt; <span class="number">0</span>) newOps = [[DELETE, N]]</span><br><span class="line">  <span class="keyword">if</span> (N === <span class="number">0</span> &amp;&amp; M &gt; <span class="number">0</span>) newOps = [[INSERT, M]]</span><br><span class="line">  <span class="keyword">if</span> (M === <span class="number">0</span> || N === <span class="number">0</span>) <span class="keyword">return</span> newOps</span><br><span class="line">  <span class="keyword">const</span> middleSnake = calcMiddleSnake(A, a0, N, B, b0, M, VForward, VBackward)</span><br><span class="line">  <span class="keyword">const</span> startX = middleSnake[<span class="number">2</span>]</span><br><span class="line">  <span class="keyword">const</span> startY = middleSnake[<span class="number">3</span>]</span><br><span class="line">  <span class="keyword">const</span> midX = middleSnake[<span class="number">4</span>]</span><br><span class="line">  <span class="keyword">const</span> midY = middleSnake[<span class="number">5</span>]</span><br><span class="line">  <span class="keyword">const</span> endX = middleSnake[<span class="number">6</span>]</span><br><span class="line">  <span class="keyword">const</span> endY = middleSnake[<span class="number">7</span>]</span><br><span class="line">  <span class="keyword">const</span> D = middleSnake[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> isVertical = middleSnake[<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">const</span> editOp = isVertical ? INSERT : DELETE</span><br><span class="line">  <span class="keyword">const</span> middleEditOps = []</span><br><span class="line">  <span class="comment">//确保点坐标的位置符合x:[0, N],y:[0, M]，才去添加middle snake的edit script</span></span><br><span class="line">  <span class="keyword">if</span> (midY &lt;= M &amp;&amp; startX &gt;= <span class="number">0</span> &amp;&amp; midX &lt;= N &amp;&amp; startY &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> editLength1 = isVertical ? midY - startY : midX - startX</span><br><span class="line">    <span class="keyword">if</span> (editLength1) middleEditOps.push([(midY - startY === midX - startX) ? RETAIN : editOp, editLength1])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (midY &gt;= <span class="number">0</span> &amp;&amp; endX &lt;= N &amp;&amp; midX &gt;= <span class="number">0</span> &amp;&amp; endY &lt;= M) &#123;</span><br><span class="line">    <span class="keyword">let</span> editLength2 = isVertical ? endY - midY : endX - midX</span><br><span class="line">    <span class="keyword">if</span> (editLength2) middleEditOps.push([(endY - midY === endX - midX) ? RETAIN : editOp, editLength2])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (D &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// diff左上角的编辑图</span></span><br><span class="line">    newOps = innerDiff(A, a0, startX, B, b0, startY, VForward, VBackward)</span><br><span class="line">    newOps.push(...middleEditOps)</span><br><span class="line">    <span class="comment">// diff右下角角的编辑图</span></span><br><span class="line">    newOps.push(...innerDiff(A, a0 + endX, N - endX, B, b0 + endY, M - endY, VForward, VBackward))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (D === <span class="number">0</span>) newOps.push(...middleEditOps)</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (startX) newOps.push([RETAIN, startX])</span><br><span class="line">    newOps.push(...middleEditOps)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> newOps</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">diff</span>(<span class="params">A, B</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> innerDiff(A, <span class="number">0</span>, A.length, B, <span class="number">0</span>, B.length, [], [])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// test</span></span><br><span class="line">diff(<span class="string">'react is the best framework'</span>, <span class="string">'preact is the best library'</span>)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">output:</span></span><br><span class="line"><span class="comment">0: ["insert", 1] insert 'p'</span></span><br><span class="line"><span class="comment">1: ["retain", 18] retain 'react is the best '</span></span><br><span class="line"><span class="comment">2: ["insert", 1] insert 'l'</span></span><br><span class="line"><span class="comment">3: ["insert", 1] insert 'i'</span></span><br><span class="line"><span class="comment">4: ["insert", 1] insert 'b'</span></span><br><span class="line"><span class="comment">5: ["delete", 1] delete 'f'</span></span><br><span class="line"><span class="comment">6: ["retain", 2] retain 'ra'</span></span><br><span class="line"><span class="comment">7: ["delete", 1] delete 'm'</span></span><br><span class="line"><span class="comment">8: ["delete", 2] delete 'ew'</span></span><br><span class="line"><span class="comment">9: ["delete", 1] delete 'o'</span></span><br><span class="line"><span class="comment">10: ["retain", 1] retain 'r'</span></span><br><span class="line"><span class="comment">11: ["insert", 1] insert 'y'</span></span><br><span class="line"><span class="comment">12: ["delete", 1] delete 'k'</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sociosarbis.github.io/study-memo/2019/10/21/myer-diff/" data-id="ck64y70vl000ajgu1ukpw1avj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/diff/">diff</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-what-does-redux-like-state-management-library-do" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/study-memo/2019/05/12/what-does-redux-like-state-management-library-do/" class="article-date">
  <time datetime="2019-05-12T13:23:04.732Z" itemprop="datePublished">2019-05-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/study-memo/2019/05/12/what-does-redux-like-state-management-library-do/">像redux这样的状态管理库是用来做什么的</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在这的很长一段之前，我一直都没有理解到为什么大型项目会需要redux这样状态管理库。因为我以前一直在觉得，redux做的无非只是把祖先的state无需通过一层层parent to child的props传递提供便利（这个功能react的context就可以做到了）和让改变数据的动作更加清晰而已。加上redux那一堆麻烦的定义文件，所以造成一直以来都不太愿意把数据放到store里面去。但是我的认识在这周发生了转变。</p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>这个转变源自于我需要做一个在同一个父组件下跟随子组件B进行view更新的子组件A。不使用store的情况就是父组件得到子组件B的变化，然后通过props传给子组件A，让子组件进行更新。可是，问题出现在，父组件也有因为涉及不当的原因，其render函数里包含了许许多多的子组件（许许多多是一个抽象的数字）。假如通过props传给子组件A，那么必然触发父组件的render方法，那么就需要一个个地去diff其下的这些子组件。这无疑是会损耗大量的性能。那么怎么解决呢。</p>
<p><strong>一个直觉的类比，我们可以像直接控制DOM一样直接让子组件A更新</strong><br>具体的做法，可以是通过ref获取到子组件A的实例，直接通过子组件A.setState的方式更新。虽然这种方法简单高效，但是这在react文档中是不推荐的，因为他让组件的关系变得复杂且难以预测，用某个学到的词来概括（反模式的），其实我的感觉就是这样子不够一般化，因为需要修改组件内部（这个跟react不提倡使用extends的方法创建组件的理由可能是一致的），添加ref。正确的模式其实还是应该通过传递props来引起更新。但是就会出现上面说的性能问题。这时候就要redux(准确上来讲是react-redux)的出场了。</p>
<p><strong>connect组件</strong><br>connect组件是react-redux提供的一个wrapper，包裹我们设计的组件形成一个高阶组件。这个wrapper主要的工作是监听store的变化，当store变化时，触发onStateUpate方法，通过用户定义好的mapStateToProps和mapDispatchToProps的方法从store中提取需要的数据设置到wrapper的state上，并在render时与非从store推导的props进行merge作为最终的props传到我们设计的组件中(如上面的子组件A)</p>
<p><strong>另一个启示</strong><br>上面的（暂且叫做）精准更新的需要的一个原因是避免有大量子Element的父组件，进行重新渲染。注意到大量这个词，也就是说，我们也可以通过减少父组件下子Element的数量，来提高性能。一个立刻能想到的可行性方案是，当父组件render的vdom间，所依赖的数据项有明显分解时，例如有分别依赖state.mails和state.friends产生列表项的，这时我们可以封装这两个列表项为两个组件并作为pureComponent，这样例如我们更新mails的时候就可以不进入friends列表项的render和HTMLElement diff阶段了了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sociosarbis.github.io/study-memo/2019/05/12/what-does-redux-like-state-management-library-do/" data-id="ck64y70wb000vjgu1y4zy9vjj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/performance/">performance</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/react/">react</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/redux/">redux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/store/">store</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-introduction-of-webpack-dll-plugin" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/study-memo/2019/03/31/introduction-of-webpack-dll-plugin/" class="article-date">
  <time datetime="2019-03-31T02:57:16.353Z" itemprop="datePublished">2019-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/study-memo/2019/03/31/introduction-of-webpack-dll-plugin/">webpack.DllPlugin简单介绍配合部分源码</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近深感由于公司项目过于庞大，在开发调试时，改动某处代码，常常会让 devServer 崩溃，需要重新启动打包，打包又要等待至少 5 分钟时间，严重影响开发效率这一弊病。于是乎，周末的时候看看有没有优化打包速度的方法，然后就来到这篇文章的主题了。</p>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>所谓的 DLL 其实是一个预编译好的 JS 文件。在使用时除了打包 app 文件的 webpack config 外，需要有一个用于打包 dll 的 webpack cofig 文件。打包 dll 端需要加入 webpack.DllPlugin，app 端需要加入 webpack.DllReferencePlugin。<br>假如不加入这个 DllPlugin，就只会生成普通的打包好的 JS 文件，加入以后就会多产出一个 manifest.json 文件，表明这个 library 的包信息。<br>manifest.json 的作用在于在 app 端引入时，配合 webpack.DllReferencePlugin，生成相应的 externals 配置和把 require dll 文件里的模块的路径转成先 require dll 的父模块然后再去 require 子模块的形式。e.g.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">require</span>(<span class="string">"../dll/alpha"</span>));</span><br><span class="line"><span class="comment">// 这行app端的require语句会在webpack编译后的包中变成以下形式</span></span><br><span class="line">__webpack_require__(<span class="string">"dll-reference alpha_21c1490edb92ec8e9390"</span>)(<span class="string">"./alpha.js"</span>)</span><br><span class="line"><span class="comment">// 前面的dll-reference alpha_21c1490edb92ec8e9390实际上是dll-reference前缀加上</span></span><br><span class="line"><span class="comment">// alpha_21c1490edb92ec8e9390这个包名</span></span><br><span class="line">__webpack_require__(<span class="string">"dll-reference alpha_21c1490edb92ec8e9390"</span>)</span><br><span class="line"><span class="comment">// 上面的这句话实际上是下面这样返回alpha_21c1490edb92ec8e9390这个全局变量</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params">module, exports</span>) </span>&#123;</span><br><span class="line"><span class="built_in">eval</span>(<span class="string">"module.exports = alpha_21c1490edb92ec8e9390;\n\n"</span>);&#125;)</span><br><span class="line"><span class="comment">// 而alpha_21c1490edb92ec8e9390这个变量的定义可以简单理解为</span></span><br><span class="line"><span class="comment">// 一个可以require alpha_21c1490edb92ec8e9390这个包内模块的__webpack_require__函数</span></span><br><span class="line"><span class="keyword">var</span> alpha_21c1490edb92ec8e9390 = (<span class="function"><span class="keyword">function</span> (<span class="params">modules</span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">module</span>.exports</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> __webpack_require__</span><br><span class="line">&#125;)(&#123;<span class="string">'./alpha'</span>: ..., ...&#125;)</span><br></pre></td></tr></table></figure>
<p><strong><em>通过 plugin 的配置项进行进一步的讲解</em></strong><br>这个 demo 来自于 webpack 官方的 example<br>dll 目录结构如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Downloads/dll</span><br><span class="line">│   a.js</span><br><span class="line">│   alpha.js</span><br><span class="line">│   b.js</span><br><span class="line">│   beta.js</span><br><span class="line">│   build.js</span><br><span class="line">│   c.jsx</span><br><span class="line">│   README.md</span><br><span class="line">│   template.md</span><br><span class="line">│   webpack.config.js</span><br><span class="line">│</span><br><span class="line">└───dist</span><br><span class="line">        alpha-manifest.json</span><br><span class="line">        beta-manifest.json</span><br><span class="line">        MyDll.alpha.js</span><br><span class="line">        MyDll.beta.js</span><br></pre></td></tr></table></figure>
<p>/dll/webpack.config.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode: <span class="string">'development'</span>,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        extensions: [<span class="string">'.js'</span>, <span class="string">'.jsx'</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">    entry: &#123;</span><br><span class="line">        alpha: [<span class="string">'./alpha'</span>, <span class="string">'./a'</span>, <span class="string">'module'</span>],</span><br><span class="line">        beta: [<span class="string">'./beta'</span>, <span class="string">'./b'</span>, <span class="string">'./c'</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.join(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">'MyDll.[name].js'</span>,</span><br><span class="line">        library: <span class="string">'[name]_[hash]'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> webpack.DllPlugin(&#123;</span><br><span class="line">            path: path.join(__dirname, <span class="string">'dist'</span>, <span class="string">'[name]-manifest.json'</span>),</span><br><span class="line">            name: <span class="string">'[name]_[hash]'</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">    ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>上面的 output.libray 和 DllPlugin 的 options.name 需要一致，假如 output.libray 为<code>&#39;[name]&#39;</code>,dll 端生成的是<code>var alpha = ...</code>而 app 端生成的是<code>module.exports = alpha_21c1490edb92ec8e9390</code>,会对应不上。<br>DllPlugin 的 options.path:manifest.json 的输出路径<br>options 里还有一个属性是 context：是一个文件路径，主要作用是 manifest.json 的 content 的 key 会转化为 js 文件路径相对于这个 context 的相对路径。<br>e.g.假如 alpha.js 的绝对路径是 C:\Users\Logicarlme\Downloads\dll\alpha.js,context 为 C:\Users\Logicarlme\Downloads\dll，那么 key 就等于’./alpha’</p>
<p><strong><em>app 端的 webpack.config.js</em></strong><br>目录结构如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Downloads/dll-user/webpack.config.js</span><br><span class="line">│   build.js</span><br><span class="line">│   example.html</span><br><span class="line">│   example.js</span><br><span class="line">│   math.js</span><br><span class="line">│   README.md</span><br><span class="line">│   template.md</span><br><span class="line">│   webpack.config.js</span><br><span class="line">│</span><br><span class="line">├───dist</span><br><span class="line">└───js</span><br><span class="line">        output.js</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /dll-user/webpack.config.js</span></span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode: <span class="string">'development'</span>,</span><br><span class="line">    entry: path.join(__dirname, <span class="string">'example.js'</span>),</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.join(__dirname, <span class="string">'js'</span>),</span><br><span class="line">        filename: <span class="string">'output.js'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">            context: path.join(__dirname, <span class="string">'..'</span>, <span class="string">'dll'</span>, <span class="string">'dist'</span>),</span><br><span class="line">            manifest: <span class="built_in">require</span>(<span class="string">'../dll/dist/alpha-manifest.json'</span>), <span class="comment">// eslint-disable-line</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">            scope: <span class="string">'beta'</span>,</span><br><span class="line">            manifest: <span class="built_in">require</span>(<span class="string">'../dll/dist/beta-manifest.json'</span>), <span class="comment">// eslint-disable-line</span></span><br><span class="line">            extensions: [<span class="string">'.js'</span>, <span class="string">'.jsx'</span>],</span><br><span class="line">        &#125;),</span><br><span class="line">    ],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// /dll-user/example.js</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">require</span>(<span class="string">'../dll/alpha'</span>));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">require</span>(<span class="string">'../dll/a'</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">require</span>(<span class="string">'beta/beta'</span>));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">require</span>(<span class="string">'beta/b'</span>));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">require</span>(<span class="string">'beta/c'</span>));</span><br><span class="line"><span class="comment">// 上面require的路径，一种是相对路径../dll/* 一种是scope类路径 beta/*，</span></span><br><span class="line"><span class="comment">// 对于路径解析下面会有进一步的说明，</span></span><br><span class="line"><span class="comment">// 需要注意的是假如是相对路径的require，那么对应的文件必须真实存在于该路径，我的理解是相对路径时，</span></span><br><span class="line"><span class="comment">// webpack会强制进行对应路径的搜索，如果文件不存在就会报错，</span></span><br><span class="line"><span class="comment">// 找到以后才会把module的处理交给后面的plugins。（未经源码验证）</span></span><br></pre></td></tr></table></figure>
<p>plugins 里有两个 webpack.DllReferencePlugin，分别对应两个打包好的 dll 文件。<br>第一个 DllReferencePlugin 的 context 属性的意思是，当一个 require 解析后的 request 路径是以这个 context 开头时，那 webpack 就不会去把这个文件的内容打包进去，<br>而是把它作为 externals 处理，代理到 dll 包，从它里面去取。<br>源码部分:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">compiler.hooks.compile.tap(<span class="string">'DllReferencePlugin'</span>, params =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> name = <span class="keyword">this</span>.options.name</span><br><span class="line">  <span class="keyword">let</span> sourceType = <span class="keyword">this</span>.options.sourceType</span><br><span class="line">  <span class="keyword">let</span> content = <span class="string">'content'</span> <span class="keyword">in</span> <span class="keyword">this</span>.options ? <span class="keyword">this</span>.options.content : <span class="literal">undefined</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="string">'manifest'</span> <span class="keyword">in</span> <span class="keyword">this</span>.options) &#123;</span><br><span class="line">    <span class="keyword">let</span> manifestParameter = <span class="keyword">this</span>.options.manifest</span><br><span class="line">    <span class="keyword">let</span> manifest</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> manifestParameter === <span class="string">'string'</span>) &#123;</span><br><span class="line">      <span class="comment">// If there was an error parsing the manifest</span></span><br><span class="line">      <span class="comment">// file, exit now because the error will be added</span></span><br><span class="line">      <span class="comment">// as a compilation error in the "compilation" hook.</span></span><br><span class="line">      <span class="keyword">if</span> (params[<span class="string">'dll reference parse error '</span> + manifestParameter]) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      manifest =</span><br><span class="line">        <span class="comment">/** @type &#123;DllReferencePluginOptionsManifest&#125; */</span> (params[</span><br><span class="line">          <span class="string">'dll reference '</span> + manifestParameter</span><br><span class="line">        ])</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      manifest = manifestParameter</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (manifest) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!name) name = manifest.name</span><br><span class="line">      <span class="keyword">if</span> (!sourceType) sourceType = manifest.type</span><br><span class="line">      <span class="keyword">if</span> (!content) content = manifest.content</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> externals = &#123;&#125;</span><br><span class="line">  <span class="keyword">const</span> source = <span class="string">'dll-reference '</span> + name</span><br><span class="line">  externals[source] = name</span><br><span class="line">  <span class="keyword">const</span> normalModuleFactory = params.normalModuleFactory</span><br><span class="line">  <span class="keyword">new</span> ExternalModuleFactoryPlugin(sourceType || <span class="string">'var'</span>, externals).apply(</span><br><span class="line">    normalModuleFactory</span><br><span class="line">  ) <span class="comment">/* 这里把"dll-reference " + name作为externals的字段，</span></span><br><span class="line"><span class="comment">      对应上面说的dll-reference alpha_21c1490edb92ec8e9390，</span></span><br><span class="line"><span class="comment">      而externals的variable的变量名就是包名alpha_21c1490edb92ec8e9390，</span></span><br><span class="line"><span class="comment">      对应上面提到的module.exports = alpha_21c1490edb92ec8e9390</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">  <span class="keyword">new</span> DelegatedModuleFactoryPlugin(&#123;</span><br><span class="line">    source: source,</span><br><span class="line">    type: <span class="keyword">this</span>.options.type,</span><br><span class="line">    scope: <span class="keyword">this</span>.options.scope,</span><br><span class="line">    context: <span class="keyword">this</span>.options.context || compiler.options.context,</span><br><span class="line">    content,</span><br><span class="line">    extensions: <span class="keyword">this</span>.options.extensions</span><br><span class="line">  &#125;).apply(normalModuleFactory)</span><br><span class="line">  <span class="comment">// 这里的DelegatedModuleFactoryPlugin的作用,</span></span><br><span class="line">  <span class="comment">// 实际上是把提到的console.log(require("../dll/alpha"));的require</span></span><br><span class="line">  <span class="comment">// 变成__webpack_require__("dll-reference alpha_21c1490edb92ec8e9390")("./alpha.js")，</span></span><br><span class="line">  <span class="comment">// 也就是说代理到dll-reference alpha_21c1490edb92ec8e9390上</span></span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 下面是DelegatedModuleFactoryPlugin的执行流程</span></span><br><span class="line">apply(normalModuleFactory) &#123;</span><br><span class="line">  <span class="keyword">const</span> scope = <span class="keyword">this</span>.options.scope;</span><br><span class="line">  <span class="keyword">if</span> (scope) &#123; <span class="comment">//这里可以看一下上面beta.dll的scope</span></span><br><span class="line">    normalModuleFactory.hooks.factory.tap(</span><br><span class="line">      <span class="string">"DelegatedModuleFactoryPlugin"</span>,</span><br><span class="line">      factory =&gt; <span class="function">(<span class="params">data, callback</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> dependency = data.dependencies[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">const</span> request = dependency.request;</span><br><span class="line">        <span class="keyword">if</span> (request &amp;&amp; request.indexOf(scope + <span class="string">"/"</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="comment">//可以看出它会先把scope去掉，让"." + 剩下的部分作为实际的require请求</span></span><br><span class="line">          <span class="keyword">const</span> innerRequest = <span class="string">"."</span> + request.substr(scope.length);</span><br><span class="line">          <span class="keyword">let</span> resolved;</span><br><span class="line">          <span class="keyword">if</span> (innerRequest <span class="keyword">in</span> <span class="keyword">this</span>.options.content) &#123;</span><br><span class="line">            <span class="comment">//会在manifest.json的content中找 实际的require请求 的对应字段</span></span><br><span class="line">            resolved = <span class="keyword">this</span>.options.content[innerRequest];</span><br><span class="line">            <span class="keyword">return</span> callback(</span><br><span class="line">              <span class="literal">null</span>,</span><br><span class="line">              <span class="keyword">new</span> DelegatedModule(</span><br><span class="line">                <span class="keyword">this</span>.options.source,</span><br><span class="line">                resolved,</span><br><span class="line">                <span class="keyword">this</span>.options.type,</span><br><span class="line">                innerRequest,</span><br><span class="line">                request</span><br><span class="line">              )</span><br><span class="line">            );</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.options.extensions.length; i++) &#123;</span><br><span class="line">            <span class="keyword">const</span> extension = <span class="keyword">this</span>.options.extensions[i];</span><br><span class="line">            <span class="keyword">const</span> requestPlusExt = innerRequest + extension;</span><br><span class="line">            <span class="keyword">if</span> (requestPlusExt <span class="keyword">in</span> <span class="keyword">this</span>.options.content) &#123;</span><br><span class="line">              resolved = <span class="keyword">this</span>.options.content[requestPlusExt];</span><br><span class="line">              <span class="keyword">return</span> callback(</span><br><span class="line">                <span class="literal">null</span>,</span><br><span class="line">                <span class="keyword">new</span> DelegatedModule(</span><br><span class="line">                  <span class="keyword">this</span>.options.source,</span><br><span class="line">                  resolved,</span><br><span class="line">                  <span class="keyword">this</span>.options.type,</span><br><span class="line">                  requestPlusExt,</span><br><span class="line">                  request + extension</span><br><span class="line">                )</span><br><span class="line">              );</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> factory(data, callback);</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    normalModuleFactory.hooks.module.tap(</span><br><span class="line">      <span class="string">"DelegatedModuleFactoryPlugin"</span>,</span><br><span class="line">      <span class="built_in">module</span> =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">module</span>.libIdent) &#123;</span><br><span class="line">          <span class="comment">// 这里其实跟上面去除scope的作用是类似的，把前面的context去掉，留下实际的request</span></span><br><span class="line">          <span class="keyword">const</span> request = <span class="built_in">module</span>.libIdent(<span class="keyword">this</span>.options);</span><br><span class="line">          <span class="keyword">if</span> (request &amp;&amp; request <span class="keyword">in</span> <span class="keyword">this</span>.options.content) &#123;</span><br><span class="line">            <span class="keyword">const</span> resolved = <span class="keyword">this</span>.options.content[request];</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> DelegatedModule(</span><br><span class="line">              <span class="keyword">this</span>.options.source,</span><br><span class="line">              resolved,</span><br><span class="line">              <span class="keyword">this</span>.options.type,</span><br><span class="line">              request,</span><br><span class="line">              <span class="built_in">module</span></span><br><span class="line">            );</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">module</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//无论是否使用scope最后生成的都是一个DelegatedModule</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//DelegatedModule的source方法可以印证上面DelegatedModuleFactoryPlugin的作用，以demo为例</span></span><br><span class="line">source(depTemplates, runtime) &#123;</span><br><span class="line">    <span class="keyword">const</span> dep = <span class="comment">/** @type &#123;DelegatedSourceDependency&#125; */</span> (<span class="keyword">this</span>.dependencies[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">const</span> sourceModule = dep.module;</span><br><span class="line">    <span class="keyword">let</span> str;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!sourceModule) &#123;</span><br><span class="line">      str = WebpackMissingModule.moduleCode(<span class="keyword">this</span>.sourceRequest);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      str = <span class="string">`module.exports = (<span class="subst">$&#123;runtime.moduleExports(&#123;</span></span></span><br><span class="line"><span class="string"><span class="subst">        <span class="built_in">module</span>: sourceModule,</span></span></span><br><span class="line"><span class="string"><span class="subst">        request: dep.request</span></span></span><br><span class="line"><span class="string"><span class="subst">            &#125;</span>)&#125;)`</span>;</span><br><span class="line"><span class="comment">// 这一部分对应webpack/lib/RuntimeTemplate.js的moduleExports方法，</span></span><br><span class="line"><span class="comment">// 生成module.exports = __webpack_require__("dll-reference alpha_21c1490edb92ec8e9390")部分</span></span><br><span class="line">      <span class="keyword">switch</span> (<span class="keyword">this</span>.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"require"</span>:</span><br><span class="line">          str += <span class="string">`(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>.request)&#125;</span>)`</span>; <span class="comment">//这里再在str后加上("./alpha.js")</span></span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"object"</span>:</span><br><span class="line">          str += <span class="string">`[<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>.request)&#125;</span>]`</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      str += <span class="string">";"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ExternalModule"><a href="#ExternalModule" class="headerlink" title="ExternalModule"></a>ExternalModule</h3><p>说了 dll,其实也要顺带说一下 ExternalModule 的原理。概括来说就是把 require 模块的内容不直接写到 bundle 中，而是把他的引用作为 module 的 exports<br>具体可以看下下面的源码：<br>lib/ExternalModule.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">//external模块为global变量</span></span><br><span class="line">getSourceForGlobalVariableExternal(variableName, type) &#123;</span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(variableName)) &#123;</span><br><span class="line">		<span class="comment">// make it an array as the look up works the same basically</span></span><br><span class="line">		variableName = [variableName];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// needed for e.g. window["some"]["thing"]</span></span><br><span class="line">	<span class="keyword">const</span> objectLookup = variableName</span><br><span class="line">		.map(<span class="function"><span class="params">r</span> =&gt;</span> <span class="string">`[<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(r)&#125;</span>]`</span>)</span><br><span class="line">		.join(<span class="string">""</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">`(function() &#123; module.exports = <span class="subst">$&#123;type&#125;</span><span class="subst">$&#123;objectLookup&#125;</span>; &#125;());`</span>;</span><br><span class="line">&#125;</span><br><span class="line">   <span class="comment">//external模块为commonjs模块</span></span><br><span class="line">getSourceForCommonJsExternal(moduleAndSpecifiers) &#123;</span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(moduleAndSpecifiers)) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">`module.exports = require(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(</span></span></span><br><span class="line"><span class="string"><span class="subst">			moduleAndSpecifiers</span></span></span><br><span class="line"><span class="string"><span class="subst">		)&#125;</span>);`</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> moduleName = moduleAndSpecifiers[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">const</span> objectLookup = moduleAndSpecifiers</span><br><span class="line">		.slice(<span class="number">1</span>)</span><br><span class="line">		.map(<span class="function"><span class="params">r</span> =&gt;</span> <span class="string">`[<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(r)&#125;</span>]`</span>)</span><br><span class="line">           .join(<span class="string">""</span>);</span><br><span class="line">       <span class="comment">//e.g. 输出格式require("some")["thing"]</span></span><br><span class="line">	<span class="keyword">return</span> <span class="string">`module.exports = require(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(</span></span></span><br><span class="line"><span class="string"><span class="subst">		moduleName</span></span></span><br><span class="line"><span class="string"><span class="subst">	)&#125;</span>)<span class="subst">$&#123;objectLookup&#125;</span>;`</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//external模块为amd或umd模块</span></span><br><span class="line">getSourceForAmdOrUmdExternal(id, optional, request) &#123;</span><br><span class="line">	<span class="keyword">const</span> externalVariable = <span class="string">`__WEBPACK_EXTERNAL_MODULE_<span class="subst">$&#123;Template.toIdentifier(</span></span></span><br><span class="line"><span class="string"><span class="subst">		<span class="string">`<span class="subst">$&#123;id&#125;</span>`</span></span></span></span><br><span class="line"><span class="string"><span class="subst">	)&#125;</span>__`</span>;</span><br><span class="line">	<span class="keyword">const</span> missingModuleError = optional</span><br><span class="line">		? <span class="keyword">this</span>.checkExternalVariable(externalVariable, request)</span><br><span class="line">		: <span class="string">""</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;missingModuleError&#125;</span>module.exports = <span class="subst">$&#123;externalVariable&#125;</span>;`</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//external模块为一个普通的全局变量</span></span><br><span class="line">getSourceForDefaultCase(optional, request) &#123;</span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(request)) &#123;</span><br><span class="line">		<span class="comment">// make it an array as the look up works the same basically</span></span><br><span class="line">		request = [request];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> variableName = request[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">const</span> missingModuleError = optional</span><br><span class="line">		? <span class="keyword">this</span>.checkExternalVariable(variableName, request.join(<span class="string">"."</span>))</span><br><span class="line">		: <span class="string">""</span>;</span><br><span class="line">	<span class="keyword">const</span> objectLookup = request</span><br><span class="line">		.slice(<span class="number">1</span>)</span><br><span class="line">		.map(<span class="function"><span class="params">r</span> =&gt;</span> <span class="string">`[<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(r)&#125;</span>]`</span>)</span><br><span class="line">           .join(<span class="string">""</span>);</span><br><span class="line">       <span class="comment">//e.g.输出格式module.exports = some["thing"];</span></span><br><span class="line">	<span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;missingModuleError&#125;</span>module.exports = <span class="subst">$&#123;variableName&#125;</span><span class="subst">$&#123;objectLookup&#125;</span>;`</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>说一下 webpack.config.externals 的配置项,下面是官方示例</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    externals: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// String</span></span><br><span class="line">            react: <span class="string">'react'</span>,</span><br><span class="line">            <span class="comment">// Object</span></span><br><span class="line">            lodash: &#123;</span><br><span class="line">                commonjs: <span class="string">'lodash'</span>,</span><br><span class="line">                amd: <span class="string">'lodash'</span>,</span><br><span class="line">                root: <span class="string">'_'</span>, <span class="comment">// indicates global variable</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// Array</span></span><br><span class="line">            subtract: [<span class="string">'./math'</span>, <span class="string">'subtract'</span>],</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// Function</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span>(<span class="params">context, request, callback</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="regexp">/^yourregex$/</span>.test(request)) &#123;</span><br><span class="line">                <span class="keyword">return</span> callback(<span class="literal">null</span>, <span class="string">'commonjs '</span> + request);</span><br><span class="line">            &#125;</span><br><span class="line">            callback();</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// Regex</span></span><br><span class="line">        /^(jquery|\$)$/i,</span><br><span class="line">    ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>之前我一直都不明白这些配置是怎么用的，尤其是以 function 使用时，callback 的第一个参数用的是 null，这到底指代什么。还有 umd，cmd，root 这些，他们是什么情况夏才会起效的。带着上面这些疑问，我阅读了下源码:lib/ExternalModuleFactoryPlugin.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> handleExternal = <span class="function">(<span class="params">value, type, callback</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> type === <span class="string">"function"</span>) &#123;</span><br><span class="line">        callback = type;</span><br><span class="line">        type = <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (value === <span class="literal">false</span>) <span class="keyword">return</span> factory(data, callback);</span><br><span class="line">    <span class="keyword">if</span> (value === <span class="literal">true</span>) value = dependency.request;</span><br><span class="line">    <span class="keyword">if</span> (type === <span class="literal">undefined</span> &amp;&amp; <span class="regexp">/^[a-z0-9]+ /</span>.test(value)) &#123;</span><br><span class="line">        <span class="keyword">const</span> idx = value.indexOf(<span class="string">" "</span>);</span><br><span class="line">        type = value.substr(<span class="number">0</span>, idx);</span><br><span class="line">        value = value.substr(idx + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    callback(</span><br><span class="line">        <span class="literal">null</span>,</span><br><span class="line">        <span class="keyword">new</span> ExternalModule(value, type || globalType, dependency.request)</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> externals === <span class="string">"string"</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (externals === dependency.request) &#123;</span><br><span class="line">        <span class="keyword">return</span> handleExternal(dependency.request, callback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(externals)) &#123;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> next = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> asyncFlag;</span><br><span class="line">        <span class="keyword">const</span> handleExternalsAndCallback = <span class="function">(<span class="params">err, <span class="built_in">module</span></span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (err) <span class="keyword">return</span> callback(err);</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">module</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (asyncFlag) &#123;</span><br><span class="line">                    asyncFlag = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> next();</span><br><span class="line">            &#125;</span><br><span class="line">            callback(<span class="literal">null</span>, <span class="built_in">module</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            asyncFlag = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= externals.length) <span class="keyword">return</span> callback();</span><br><span class="line">            handleExternals(externals[i++], handleExternalsAndCallback);</span><br><span class="line">        &#125; <span class="keyword">while</span> (!asyncFlag);</span><br><span class="line">        asyncFlag = <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    next();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (externals <span class="keyword">instanceof</span> <span class="built_in">RegExp</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (externals.test(dependency.request)) &#123;</span><br><span class="line">        <span class="keyword">return</span> handleExternal(dependency.request, callback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> externals === <span class="string">"function"</span>) &#123;</span><br><span class="line">    externals.call(</span><br><span class="line">        <span class="literal">null</span>,</span><br><span class="line">        context,</span><br><span class="line">        dependency.request,</span><br><span class="line">        (err, value, type) =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (err) <span class="keyword">return</span> callback(err);</span><br><span class="line">            <span class="keyword">if</span> (value !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">                handleExternal(value, type, callback);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                callback();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (</span><br><span class="line">    <span class="keyword">typeof</span> externals === <span class="string">"object"</span> &amp;&amp;</span><br><span class="line">    <span class="built_in">Object</span>.prototype.hasOwnProperty.call(externals, dependency.request)</span><br><span class="line">) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleExternal(externals[dependency.request], callback);</span><br><span class="line">&#125;</span><br><span class="line">callback();</span><br><span class="line">&#125;;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>上面的各个条件语句分别对应 externals 里各种形式的配置。<br>分别举例 1.<code>externals: &#39;react&#39;</code> 会转成</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">callback(<span class="literal">null</span>, <span class="keyword">new</span> ExternalModule(<span class="string">'react'</span>, <span class="literal">undefined</span> || globalType, <span class="string">'react'</span>));</span><br></pre></td></tr></table></figure>
<p>tips：from lib/WebpackOptionsApply.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (options.externals) &#123;</span><br><span class="line">    ExternalsPlugin = <span class="built_in">require</span>(<span class="string">'./ExternalsPlugin'</span>);</span><br><span class="line">    <span class="keyword">new</span> ExternalsPlugin(</span><br><span class="line">        options.output.libraryTarget,</span><br><span class="line">        <span class="comment">// 当设置了externals后，会添加一个ExternalsPlugin，而它的type默认为output.libraryTarget, </span></span><br><span class="line">        <span class="comment">// 而libraryTarget默认为'var',这里是一个伏笔，后面会提到</span></span><br><span class="line">        options.externals</span><br><span class="line">    ).apply(compiler);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.<code>externals: [&#39;react&#39;, &#39;jquery&#39;]</code> 只不过是单个 externals 推广为多个，把里面的每一个配置按除 2 以外的规则进行处理,数组里面可以是 string, regExp 和 Object 3.<code>externals: /^(jquery|\$)$/i</code> 当 require 的 request 符合正则的形式时，会把这个 request 与 1 一样处理</p>
<p>4.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">externals: <span class="function"><span class="keyword">function</span>(<span class="params">context, request, callback</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="regexp">/^yourregex$/</span>.test(request)) &#123;</span><br><span class="line">        <span class="keyword">return</span> callback(<span class="literal">null</span>, <span class="string">'commonjs '</span> + request)</span><br><span class="line">      &#125;</span><br><span class="line">      callback()</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<p>如果是 function 时就直接执行这个 function，而 callback 参数为</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(err, value, type) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> callback(err);</span><br><span class="line">    <span class="keyword">if</span> (value !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">        handleExternal(value, type, callback);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        callback();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>这里可以回答上面的问题，callback 的第一个参数 null 到底指的是什么，指的是否出现 err。<br>第二个参数’commonjs ‘ + request，为包导出方式 + 空格 + 模块名的形式，它会在 handleExternal 中以第一个空格分成两个字符串，字符串 1 表示 ExternalModule 的导出形式，字符串 2 为模块名 5.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">externals: &#123;</span><br><span class="line">      <span class="comment">// String</span></span><br><span class="line">      react: <span class="string">'react'</span>,</span><br><span class="line">      <span class="comment">// Object</span></span><br><span class="line">      lodash: &#123;</span><br><span class="line">        commonjs: <span class="string">'lodash'</span>,</span><br><span class="line">        amd: <span class="string">'lodash'</span>,</span><br><span class="line">        root: <span class="string">'_'</span> <span class="comment">// indicates global variable</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// Array</span></span><br><span class="line">      subtract: [<span class="string">'./math'</span>, <span class="string">'subtract'</span>]</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<p>上面 Object 的情况有三种形式：<br><strong>第一种 value 是 string，实际上是 value 是 Object 的特殊情况。表示不论是以 commonjs, amd, root 等哪种方式导出，他的变量名都是 react</strong><br><strong>第二种 value 是 Object, 表示根据导出的方式，返回对应的变量名</strong><br>e.g. commonjs 时是 module.exports = require(‘loadsh’) root 时是 module.exports = _<br>那这个导出方式是以什么决定的呢？如果是普通的 externals,那么就跟 1 中的 tips 代码注释写的一样，跟打包时 output.libraryTarget 一致的。如果是 dll 的情况就取<br>DllReferencePlugin 的 options.sourceType 或者 manifest.json 的 type 字段，如果都没有默认就是 var。这里就是 1 中的 tips 里说的伏笔，因为我之前没有在官方的例子中，找到有用过 var 字段的，以为默认是 root 或者 global 因为一般只看到 externals 中用到这两种表示全局的。但事实上他们不是划为同一种进行处理的，<br>看一下源码:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//lib/ExternalModule.js</span></span><br><span class="line"><span class="keyword">switch</span> (<span class="keyword">this</span>.externalType) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"this"</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"window"</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"self"</span>:</span><br><span class="line">				...</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"global"</span>:</span><br><span class="line">				...</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"commonjs"</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"commonjs2"</span>:</span><br><span class="line">				...</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"amd"</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"amd-require"</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"umd"</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"umd2"</span>:</span><br><span class="line">        ...</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				...</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>
<p>并且在分情况返回变量名的处理方法是<code>this.request[this.externalType]</code>，也就是说以’var’和上面的 lodash 为例子的话，那就相当于({commonjs: ‘lodash’,amd:’lodash’,root: ‘_‘ })[‘var’]。那这样的话自然在编译时就变成了<code>module.exports=undefined</code><br><strong>_第三种 value 是 Array，它的处理方式以当包导出方式是以 var 为例说明,根据上面的 switch condition 可知当为 var 时，按 defaultCase 处理</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">getSourceForDefaultCase(optional, request) &#123;</span><br><span class="line">    ...</span><br><span class="line"><span class="comment">// request参数代入我们的['./math', 'subtract']，</span></span><br><span class="line"><span class="comment">// 可得最后return的值为module.exports = ./math["subtract"]，</span></span><br><span class="line"><span class="comment">// 可以看出数组的第一个参数是作为模块名或者变量名，后面的参数作为对象的属性，一层层获取的。</span></span><br><span class="line"><span class="comment">// 然后就是var的情况./math["subtract"]，显然是不合法的。</span></span><br><span class="line"><span class="comment">// 如果是commonjs的话，就是require('./math')["subtract"],这个代入getSourceForCommonJsExternal可以知道。</span></span><br><span class="line">    <span class="keyword">const</span> variableName = request[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">const</span> objectLookup = request</span><br><span class="line">			.slice(<span class="number">1</span>)</span><br><span class="line">			.map(<span class="function"><span class="params">r</span> =&gt;</span> <span class="string">`[<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(r)&#125;</span>]`</span>)</span><br><span class="line">            .join(<span class="string">""</span>);</span><br><span class="line">        <span class="comment">//e.g.输出格式module.exports = some["thing"];</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;missingModuleError&#125;</span>module.exports = <span class="subst">$&#123;variableName&#125;</span><span class="subst">$&#123;objectLookup&#125;</span>;`</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>上面的解析写的比较乱，而且有很多文章内的引用，下次可以考虑使用锚点进行页内跳转。<br>dll 的工作流程大概是，通过 DllPlugin 打包 library 获得 js 和 manifest 文件，使用时通过 DllReferencePlugin 读取 manifest 文件，解析 dll 中包含的子模块名等信息。<br>DllReferencePlugin 内部，创建 ExternalModule，把 dll 加入到 externals 中，然后通过 DelegatedModule，把对实际文件的 require 请求，代理到 dll 包中。<br><strong>p.s.：使用<code>HTMLWebpackPlugin</code>的默认配置并不会在使用<code>DllReferencePlugin</code>后把加载<code>dll</code>script标签加入到打包后的html里。</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sociosarbis.github.io/study-memo/2019/03/31/introduction-of-webpack-dll-plugin/" data-id="ck64y70ym003ujgu1j4sf4sq8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/dll/">dll</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/externals/">externals</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/study-memo/tags/webpack/">webpack</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/study-memo/">&laquo; Prev</a><a class="page-number" href="/study-memo/">1</a><span class="page-number current">2</span><a class="page-number" href="/study-memo/page/3/">3</a><a class="extend next" rel="next" href="/study-memo/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/AST/">AST</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/C/">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/CLI/">CLI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/Clang/">Clang++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/HTML/">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/HTTP/">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/IIFE/">IIFE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/Needleman-Wunsch/">Needleman-Wunsch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/SSR/">SSR</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/Vue/">Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/Yox/">Yox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/algorithm/">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/bin-pack/">bin-pack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/compile/">compile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/diff/">diff</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/dll/">dll</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/eventloop/">eventloop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/expression/">expression</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/externals/">externals</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/framework/">framework</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/hoisting/">hoisting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/hot-reload/">hot-reload</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/interview/">interview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/leetcode/">leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/location指令/">location指令</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/meta/">meta</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/mvvm/">mvvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/parser/">parser</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/performance/">performance</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/plugin/">plugin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/promise/">promise</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/querySelector/">querySelector</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/react/">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/redux/">redux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/setTimeout/">setTimeout</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/sorting/">sorting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/sprite/">sprite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/stack/">stack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/store/">store</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/stream/">stream</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/submodule/">submodule</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/template/">template</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/temporary-variable/">temporary variable</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/viewport/">viewport</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/vue/">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/watcher/">watcher</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/webpack/">webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/websocket/">websocket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/whistle/">whistle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/windows/">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/立即执行函数/">立即执行函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/study-memo/tags/语义化/">语义化</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/study-memo/tags/AST/" style="font-size: 10px;">AST</a> <a href="/study-memo/tags/C/" style="font-size: 10px;">C++</a> <a href="/study-memo/tags/CLI/" style="font-size: 10px;">CLI</a> <a href="/study-memo/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/study-memo/tags/Clang/" style="font-size: 10px;">Clang++</a> <a href="/study-memo/tags/HTML/" style="font-size: 15px;">HTML</a> <a href="/study-memo/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/study-memo/tags/IIFE/" style="font-size: 10px;">IIFE</a> <a href="/study-memo/tags/Needleman-Wunsch/" style="font-size: 10px;">Needleman-Wunsch</a> <a href="/study-memo/tags/SSR/" style="font-size: 10px;">SSR</a> <a href="/study-memo/tags/Vue/" style="font-size: 10px;">Vue</a> <a href="/study-memo/tags/Yox/" style="font-size: 10px;">Yox</a> <a href="/study-memo/tags/algorithm/" style="font-size: 17.5px;">algorithm</a> <a href="/study-memo/tags/bin-pack/" style="font-size: 10px;">bin-pack</a> <a href="/study-memo/tags/compile/" style="font-size: 10px;">compile</a> <a href="/study-memo/tags/diff/" style="font-size: 10px;">diff</a> <a href="/study-memo/tags/dll/" style="font-size: 10px;">dll</a> <a href="/study-memo/tags/eventloop/" style="font-size: 10px;">eventloop</a> <a href="/study-memo/tags/expression/" style="font-size: 10px;">expression</a> <a href="/study-memo/tags/externals/" style="font-size: 10px;">externals</a> <a href="/study-memo/tags/framework/" style="font-size: 10px;">framework</a> <a href="/study-memo/tags/git/" style="font-size: 12.5px;">git</a> <a href="/study-memo/tags/hoisting/" style="font-size: 10px;">hoisting</a> <a href="/study-memo/tags/hot-reload/" style="font-size: 10px;">hot-reload</a> <a href="/study-memo/tags/interview/" style="font-size: 20px;">interview</a> <a href="/study-memo/tags/javascript/" style="font-size: 15px;">javascript</a> <a href="/study-memo/tags/leetcode/" style="font-size: 10px;">leetcode</a> <a href="/study-memo/tags/location指令/" style="font-size: 10px;">location指令</a> <a href="/study-memo/tags/meta/" style="font-size: 10px;">meta</a> <a href="/study-memo/tags/mvvm/" style="font-size: 10px;">mvvm</a> <a href="/study-memo/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/study-memo/tags/parser/" style="font-size: 10px;">parser</a> <a href="/study-memo/tags/performance/" style="font-size: 12.5px;">performance</a> <a href="/study-memo/tags/plugin/" style="font-size: 10px;">plugin</a> <a href="/study-memo/tags/promise/" style="font-size: 10px;">promise</a> <a href="/study-memo/tags/querySelector/" style="font-size: 10px;">querySelector</a> <a href="/study-memo/tags/react/" style="font-size: 10px;">react</a> <a href="/study-memo/tags/redux/" style="font-size: 10px;">redux</a> <a href="/study-memo/tags/setTimeout/" style="font-size: 10px;">setTimeout</a> <a href="/study-memo/tags/sorting/" style="font-size: 10px;">sorting</a> <a href="/study-memo/tags/sprite/" style="font-size: 10px;">sprite</a> <a href="/study-memo/tags/stack/" style="font-size: 10px;">stack</a> <a href="/study-memo/tags/store/" style="font-size: 10px;">store</a> <a href="/study-memo/tags/stream/" style="font-size: 10px;">stream</a> <a href="/study-memo/tags/submodule/" style="font-size: 10px;">submodule</a> <a href="/study-memo/tags/template/" style="font-size: 12.5px;">template</a> <a href="/study-memo/tags/temporary-variable/" style="font-size: 10px;">temporary variable</a> <a href="/study-memo/tags/viewport/" style="font-size: 10px;">viewport</a> <a href="/study-memo/tags/vue/" style="font-size: 17.5px;">vue</a> <a href="/study-memo/tags/watcher/" style="font-size: 10px;">watcher</a> <a href="/study-memo/tags/webpack/" style="font-size: 10px;">webpack</a> <a href="/study-memo/tags/websocket/" style="font-size: 10px;">websocket</a> <a href="/study-memo/tags/whistle/" style="font-size: 10px;">whistle</a> <a href="/study-memo/tags/windows/" style="font-size: 10px;">windows</a> <a href="/study-memo/tags/立即执行函数/" style="font-size: 10px;">立即执行函数</a> <a href="/study-memo/tags/语义化/" style="font-size: 10px;">语义化</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/study-memo/archives/2018/10/">October 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/study-memo/2020/08/16/misunderstandings-of-nginx-location-config/">nginx location指令配置的误解</a>
          </li>
        
          <li>
            <a href="/study-memo/2020/04/19/optimization-techniques-for-better-performance-of-vue-app/">Vue应用性能调优技巧</a>
          </li>
        
          <li>
            <a href="/study-memo/2020/03/18/experience-of-using-git-submodule/">git submodule的使用经验</a>
          </li>
        
          <li>
            <a href="/study-memo/2020/02/23/yox-research-template-expression-episode/">Yox框架研究（1）—模板表达式编译篇</a>
          </li>
        
          <li>
            <a href="/study-memo/2020/02/01/vue-ssr-demo-following-official-guide/">按照官方指南实践vue SSR</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Sociosarbis<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/study-memo/" class="mobile-nav-link">Home</a>
  
    <a href="/study-memo/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/study-memo/fancybox/jquery.fancybox.css">
  <script src="/study-memo/fancybox/jquery.fancybox.pack.js"></script>


<script src="/study-memo/js/script.js"></script>



  </div>
</body>
</html>